<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Be My Val? ğŸ’•</title>

  <style>
    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    /* Global & Reset */
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #fff0f5 0%, #ffebee 100%);
      color: #d32f2f;
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      overflow: hidden;
    }

    .container {
      max-width: 600px;
      padding: 20px;
    }

    h1, p {
      margin: 20px 0;
    }

    input[type="text"] {
      padding: 12px;
      font-size: 18px;
      border: 2px solid #f48fb1;
      border-radius: 8px;
      width: 80%;
      max-width: 320px;
    }

    button {
      padding: 14px 28px;
      font-size: 18px;
      background-color: #ec407a;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin: 10px;
      transition: all 0.3s;
    }

    button:hover {
      background-color: #d81b60;
      transform: scale(1.05);
    }

    .error {
      color: #f44336;
      font-size: 16px;
      margin-top: 8px;
    }

    /* Link sharing page */
    .link-container {
      margin-top: 20px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }

    .share-link {
      font-size: 16px;
      word-break: break-all;
      margin-bottom: 12px;
      color: #333;
    }

    .copy-feedback {
      font-size: 14px;
      color: #4caf50;
      display: none;
    }

    /* Question page */
    .question-wrapper {
      position: relative;
      margin-bottom: 40px;
    }

    .heart-bg {
      position: absolute;
      font-size: 180px;
      opacity: 0.07;
      color: #ff6b81;
      pointer-events: none;
      animation: pulse 8s infinite ease-in-out;
      z-index: -1;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    @keyframes pulse {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50%      { transform: translate(-50%, -50%) scale(1.15); }
    }

    .question {
      font-size: 32px;
      margin: 0;
      animation: fadeInScale 1.2s ease-out forwards;
    }

    @keyframes fadeInScale {
      from { opacity: 0; transform: scale(0.85); }
      to   { opacity: 1; transform: scale(1); }
    }

    .buttons {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
    }

    #yes-btn {
      background-color: #4caf50;
    }

    #yes-btn:hover {
      background-color: #388e3c;
    }

    #no-btn {
      background-color: #f44336;
      position: absolute;
      transition: all 0.3s ease-out;
      padding: 14px 28px;
      border-radius: 50px;
      font-weight: bold;
      box-shadow: 0 4px 10px rgba(244, 67, 54, 0.4);
    }

    #no-btn:hover {
      background-color: #d32f2f;
    }

    /* Confetti */
    .confetti {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 10;
      display: none;
    }

    .confetti-piece {
      position: absolute;
      width: 10px;
      height: 20px;
      background: #ffd300;
      opacity: 0.8;
      animation: fall 3s linear infinite;
    }

    @keyframes fall {
      to {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* Modal */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.65);
      display: none;
      place-items: center;
      z-index: 20;
      opacity: 0;
      transition: opacity 0.5s;
    }

    .modal.show {
      display: flex;
      opacity: 1;
    }

    .modal-content {
      background: white;
      padding: 32px 24px;
      border-radius: 16px;
      max-width: 420px;
      width: 90%;
      transform: scale(0.8);
      transition: transform 0.5s;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }

    .modal.show .modal-content {
      transform: scale(1);
    }

    .modal img {
      display: block;
      margin: 20px auto 30px;
      max-width: 90%;
      width: 280px;
      max-width: 320px;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.18);
      border: 1px solid #ffebee;
      background: white;
      padding: 10px;
    }

    .modal a {
      color: #ec407a;
      font-weight: bold;
      text-decoration: none;
      font-size: 18px;
    }

    .fallback {
      font-size: 20px;
      padding: 20px;
    }

    /* Footer */
    footer {
      position: fixed;
      bottom: 12px;
      left: 0;
      right: 0;
      text-align: center;
      color: #777;
      font-size: 13px;
      pointer-events: none;
    }

    /* Floating music notes */
    @keyframes floatNote {
      to {
        transform: translateY(-120vh) rotate(720deg);
        opacity: 0;
      }
    }
  </style>
</head>
<body>

  <!-- Welcome -->
  <div class="container" id="welcome">
    <h1>What is your partnerâ€™s name? ğŸ’•</h1>
    <input type="text" id="partner-name" placeholder="Enter name here" autocomplete="off"/>
    <button id="continue-btn">Continue</button>
    <p class="error" id="error-msg"></p>
  </div>

  <!-- Share link -->
  <div class="container" id="link-page" style="display:none;">
    <h1>Share this special link! ğŸ’•</h1>
    <div class="link-container">
      <p class="share-link" id="share-link"></p>
      <button id="copy-btn">Copy Link</button>
      <p class="copy-feedback" id="copy-feedback">Copied! ğŸ’•</p>
    </div>
  </div>

  <!-- Question page -->
  <div class="container" id="question-page" style="display:none;">
    <div class="question-wrapper">
      <div class="heart-bg">â¤ï¸</div>
      <h1 class="question" id="question-text"></h1>
    </div>

    <div class="buttons">
      <button id="yes-btn">Yes âœ…</button>
      <button id="no-btn">No âŒ</button>
    </div>

    <p class="fallback" id="fallback-msg" style="display:none;"></p>
  </div>

  <!-- Confetti container -->
  <div class="confetti" id="confetti"></div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <h2>Yay! ğŸ‰â¤ï¸</h2>

      <img 
        src="the-power-of-music.jpeg" 
        alt="The Power of Music by Kelvin Tabi - Ebook Cover"
        loading="lazy"
      >

      <p>While you're in such a loving mood, check out my ebook</p>
      <h3 style="margin:10px 0; color:#d81b60;">The Power of Music</h3>
      <p style="font-size:17px; margin-bottom:24px;">
        Discover how music can deepen connections, spark romance, and bring people closer â¤ï¸
      </p>

      <p>
        <a href="https://selar.com/8e83411u16" target="_blank">
          Learn more about the ebook â†’
        </a>
      </p>

      <button onclick="document.getElementById('modal').classList.remove('show')" style="margin-top:24px;">
        Close
      </button>
    </div>
  </div>

  <footer>Made with â¤ï¸ by Kelvin Tabi</footer>

  <script>
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Helpers
    function showElement(id) { document.getElementById(id).style.display = 'block'; }
    function hideElement(id) { document.getElementById(id).style.display = 'none'; }

    const yesSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-magic-sparkle-whoosh-2345.mp3');

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Welcome â†’ generate link
    document.getElementById('continue-btn').addEventListener('click', () => {
      const name = document.getElementById('partner-name').value.trim();
      const error = document.getElementById('error-msg');

      if (!name) {
        error.textContent = 'Please enter a name ğŸ’•';
        return;
      }

      error.textContent = '';

      const encoded = encodeURIComponent(name);
      const link = `${location.origin}${location.pathname}?valentine=${encoded}`;
      document.getElementById('share-link').textContent = link;

      hideElement('welcome');
      showElement('link-page');
    });

    // Copy link
    document.getElementById('copy-btn').addEventListener('click', () => {
      const link = document.getElementById('share-link').textContent;
      navigator.clipboard.writeText(link).then(() => {
        const fb = document.getElementById('copy-feedback');
        fb.style.display = 'block';
        setTimeout(() => fb.style.display = 'none', 2000);
      });
    });

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Question page logic
    function initQuestionPage() {
      const params = new URLSearchParams(location.search);
      const encodedName = params.get('valentine');
      let name = '';

      if (encodedName) {
        try {
          name = decodeURIComponent(encodedName).trim();
        } catch {}
      }

      if (!name) {
        const msg = document.getElementById('fallback-msg');
        msg.textContent = 'Someone made this special page for you! ğŸ’•';
        const btn = document.createElement('button');
        btn.textContent = 'Go to main page';
        btn.style.marginTop = '20px';
        btn.onclick = () => location.href = location.origin + location.pathname;
        msg.appendChild(btn);
        msg.style.display = 'block';
        hideElement('question-text');
        hideElement('buttons');
        return;
      }

      // Set title
      document.title = `${name}, will you be my Val? ğŸ’•`;

      const questionEl = document.getElementById('question-text');
      questionEl.textContent = `${name}, would you be my Val? â¤ï¸`;

      // Check if already answered
      const answered = localStorage.getItem(`valentine_${encodedName}`);
      if (answered === 'yes') {
        questionEl.innerHTML = `${name}, you already said Yes! ğŸ¥°â¤ï¸`;
        hideElement('buttons');
        return;
      }
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // No button logic
    const noBtn = document.getElementById('no-btn');
    const noTexts = [
      'ğŸ˜ nope!', 'try harder~', 'not today! ğŸ˜‰', 'catch me if you can!',
      'almost... ğŸ˜‚', 'youâ€™re getting warmerâ€¦ or not~ ğŸ”¥',
      'heeey stop bullying me! ğŸ˜­', 'this is harassment cutie ğŸ’…',
      'maybe next lifetime? ğŸ‘€'
    ];
    let textIndex = 0;

    function moveNoButton(e) {
      const isTouch = e.type.startsWith('touch');
      const rect = noBtn.getBoundingClientRect();
      const vw = window.innerWidth;
      const vh = window.innerHeight;
      const w = rect.width;
      const h = rect.height;

      let cx = isTouch ? e.touches[0]?.clientX : e.clientX;
      let cy = isTouch ? e.touches[0]?.clientY : e.clientY;

      if (!cx || !cy) {
        cx = vw / 2;
        cy = vh / 2;
      }

      const minDist = window.innerWidth < 768 ? 160 : 120;

      let x, y;
      do {
        x = Math.random() * (vw - w - 40) + 20;
        y = Math.random() * (vh - h - 40) + 20;
      } while (Math.hypot(x + w/2 - cx, y + h/2 - cy) < minDist);

      noBtn.style.left = x + 'px';
      noBtn.style.top  = y + 'px';
      noBtn.style.transform = `rotate(${Math.random()*8 - 4}deg) scale(1.05)`;

      noBtn.textContent = noTexts[textIndex];
      textIndex = (textIndex + 1) % noTexts.length;

      setTimeout(() => {
        noBtn.textContent = 'No âŒ';
      }, 1400);
    }

    ['mouseenter', 'mousedown', 'touchstart', 'touchmove', 'touchend'].forEach(ev => {
      noBtn.addEventListener(ev, moveNoButton, { passive: true });
    });

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Yes button + celebration
    const yesBtn   = document.getElementById('yes-btn');
    const confetti = document.getElementById('confetti');
    const modal    = document.getElementById('modal');

    function createConfetti() {
      for (let i = 0; i < 100; i++) {
        const p = document.createElement('div');
        p.className = 'confetti-piece';
        p.style.left = Math.random() * 100 + '%';
        p.style.background = `hsl(${Math.random()*360}, 90%, 60%)`;
        p.style.animationDelay = Math.random() * 3 + 's';
        p.style.animationDuration = (3 + Math.random()*2) + 's';
        confetti.appendChild(p);
      }
    }

    function createMusicNotes() {
      const notes = ['â™ª','â™«','â™¬','ğŸµ','ğŸ¶'];
      for (let i = 0; i < 60; i++) {
        const n = document.createElement('div');
        n.textContent = notes[Math.floor(Math.random()*notes.length)];
        n.style.position = 'absolute';
        n.style.left = Math.random()*100 + 'vw';
        n.style.top = '-20px';
        n.style.fontSize = (20 + Math.random()*30) + 'px';
        n.style.color = `hsl(${Math.random()*60 + 330}, 90%, 55%)`;
        n.style.pointerEvents = 'none';
        n.style.animation = `floatNote ${4 + Math.random()*3}s linear forwards`;
        document.body.appendChild(n);
        setTimeout(() => n.remove(), 8000);
      }
    }

    yesBtn.addEventListener('click', () => {
      const encoded = new URLSearchParams(location.search).get('valentine');
      if (encoded) localStorage.setItem(`valentine_${encoded}`, 'yes');

      createConfetti();
      createMusicNotes();
      showElement('confetti');
      yesSound.currentTime = 0;
      yesSound.play().catch(() => {});

      setTimeout(() => {
        confetti.innerHTML = '';
        hideElement('confetti');
        modal.classList.add('show');
      }, 5000);
    });

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Initialize
    if (location.search.includes('valentine=')) {
      hideElement('welcome');
      hideElement('link-page');
      showElement('question-page');
      initQuestionPage();
    } else {
      hideElement('link-page');
      hideElement('question-page');
      showElement('welcome');
    }
  </script>
</body>
</html>